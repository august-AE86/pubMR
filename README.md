pubMR
==========
pubMR是R平台下一个高效的PubMed文本挖掘工具，集合了：检索下载、解析抽取、基本统计、多维矩阵、论文相似、热点分析、概念识别和网络分析等多种功能。

pubMR is an R package designed for text mining of the PubMed database. Additionally, it provide some highly customized metics to evaluate and visualize results for downstream analysis.


## Authors

[崔雷] (Cuilei)

[周晓北] (Zhou Xiaobei)

## Installation
### for Linux and Mac:

```r
install.packages("devtools")
devtools::install_github("xizhou/pubMR")
```

### for WIN user:

```r
install.packages("devtools")
install.packages("RCurl", type="win.binary")
install.packages("stringi",type="win.binary")
devtools::install_github("xizhou/pubMR",upgrade="never",force=TRUE)
```

<!-- 
## Vignettes
pubMR.pdf](https://github.com/xizhou/pubMR/tree/master/vignettes/pubMR.pdf)
 -->
 
## Usage
### A quick start:
```r
library(pubMR)
m <- '"neoplasms"[MeSH Terms] AND "serine/metabolism"[Mesh Terms] AND ("2017/01/01"[PDAT] : "2018/12/31"[PDAT])'
obj <- txtList(input=m)
```

```text
obj
An object of class "txtList" containing 95 articles
with slot names: PMID,TI,AB,JT,DP,ISSN,MH,SH,MAJR,AU.
```
All text information are storing in format of **txtList**. **txtList** includes PMID, TI(title), AB(abstract), JT(journal title), DP(date publish), ISSN,
MH(MeSH heading), SH(MeSH subheading), MAJR(major topic, asterisks on MeSH headings and subheadings) and AU(author). 
### Advanced operations:
**Load/save files:** 
- Import a "PubMed" file downloaded from the PubMed database into R program:

<p align="center">
  <img src="https://github.com/xizhou/pubMR/blob/master/screenshot.png?raw=true" alt="PubMed"/>
</p>

```r
library(pubMR)
obj <- txtList(input="pubmed-neoplasmsM-set.txt",inputType="PubMed")
```
- import an "xml" file:
```r
library(pubMR)
obj <- txtList(input="pubmed_result.xml",inputType="xml")
```
- Save as an "xml" file:
```r
library(pubMR)
library(XML)
m <- '"neoplasms"[MeSH Terms] AND "serine/metabolism"[Mesh Terms] AND ("2017/01/01"[PDAT] : "2018/12/31"[PDAT])'
obj1 <- txtList(input=m,outputType='xml')
saveXML(obj1,file="result.xml")
```
**Produce co-occurrence-matrices:** 
- A MAJR(MeSH/subheading)-PMID co-occurrence-matrix can be generated by:
```r
library(data.table)
library(tidyr)
library(pubMR)
m <- '"neoplasms"[MeSH Terms] AND "serine/metabolism"[Mesh Terms] AND ("2017/01/01"[PDAT] : "2018/12/31"[PDAT])'
obj <- txtList(input=m)
obj1=data.table(PMID=obj@PMID,MAJR=obj@MAJR)
MAJR <- obj1[,MAJR]
idx <- sapply(MAJR,is.null)
obj1 <- obj1[!idx,]
obj1 = obj1 %>% unnest(MAJR) 
V <- table(obj1[,c("MAJR","PMID")])
```
```text
V
                                                 PMID
MAJR                                                27297361 27748765 27777073 27889207 27890529
  A Kinase Anchor Proteins/metabolism                    0        0        0        0        0
  Acquired Immunodeficiency Syndrome/metabolism          0        0        0        0        0
  Activating Transcription Factor 4/metabolism           0        0        0        0        0
  Adaptor Proteins, Signal Transducing/genetics          0        0        0        0        0
  Adaptor Proteins, Signal Transducing/metabolism        0        0        0        0        0
```

- A MAJR-MAJR co-occurrence-matrix can be generated by:
```r
V1 <- crossprod(t(V))
```
```text
V1                                                 MAJR
MAJR                                                A Kinase Anchor Proteins/metabolism Acquired Immunodeficiency Syndrome/metabolism Activating Transcription Factor 4/metabolism
  A Kinase Anchor Proteins/metabolism                                               1                                             0                                            0
  Acquired Immunodeficiency Syndrome/metabolism                                     0                                             1                                            0
  Activating Transcription Factor 4/metabolism                                      0                                             0                                            1
  Adaptor Proteins, Signal Transducing/genetics                                     0                                             0                                            0
  Adaptor Proteins, Signal Transducing/metabolism                                   0                                             0                                            0
```
- The co-occurrence-matrix can be put into "gCluto" program:
```r
library(slam)
x <- V1
x <- x[!rowSums(x)==0,] 
x <- x[!colSums(x)==0,] 
slam::write_stm_CLUTO(x,file="dat.mat")
```
<p align="center">
  <img src="https://github.com/xizhou/pubMR/blob/master/fig.png?raw=true" alt="gcluto"/>
</p>